# üöÄ Pramiti AI - Docker Deployment & Continuous Updates

Your complete guide to deploying and maintaining Pramiti AI on Contabo VPS with Docker.

## ‚ö° Quick Start (3 Commands)

```bash
# 1. Initial deployment (one-time, 10-15 minutes)
./deploy_interactive.sh

# 2. Make changes in VS Code, then deploy updates (2-3 minutes)
./update_deployment.sh

# 3. Check VPS status anytime
./check_status.sh
```

That's it! Your complete CI/CD pipeline in 3 commands.

---

## üì¶ What You Get

### üõ†Ô∏è Automated Scripts

| Script | Purpose | Usage |
|--------|---------|-------|
| **deploy_interactive.sh** | Initial VPS setup | One-time deployment |
| **update_deployment.sh** | Push updates to VPS | Every time you make changes |
| **check_status.sh** | Monitor VPS health | Check anytime |

### üê≥ Docker Services

- **pramiti-ai**: FastAPI application (Port 8084)
- **postgres**: PostgreSQL 15 database
- **redis**: Redis cache
- **nginx**: Reverse proxy with SSL support

### üìö Documentation

- **CONTINUOUS_DEPLOYMENT.md**: Complete workflow guide
- **DEPLOYMENT_GUIDE.md**: Detailed deployment manual
- **QUICK_DEPLOY.md**: Quick reference
- **CONTABO_DEPLOYMENT_SUMMARY.md**: Overview

---

## üéØ Typical Workflow

### Day 1: Initial Deployment

```bash
# Run interactive deployment
./deploy_interactive.sh
```

**You'll be asked for:**
- VPS IP address
- SSH username (usually `root`)
- OpenAI API key
- Domain name (optional)

**Script will automatically:**
- ‚úÖ Install Docker & Docker Compose
- ‚úÖ Clone repository
- ‚úÖ Configure environment
- ‚úÖ Setup firewall
- ‚úÖ Build & start all services
- ‚úÖ Verify deployment

**Result:** Your platform is live!

### Day 2+: Making Updates

```bash
# 1. Edit code in VS Code
code web/enhanced-dashboard.html

# 2. Test locally (optional)
python3 api_server.py
# Visit http://localhost:8084

# 3. Deploy to VPS
./update_deployment.sh
```

**Script will automatically:**
- ‚úÖ Commit your changes
- ‚úÖ Push to GitHub
- ‚úÖ Pull on VPS
- ‚úÖ Rebuild Docker images
- ‚úÖ Restart services
- ‚úÖ Verify health

**Result:** Updates live in 2-3 minutes!

### Anytime: Check Status

```bash
./check_status.sh
```

Shows:
- Service status
- Health check results
- Resource usage (CPU, memory, disk)
- Recent logs

---

## üîß Configuration

### VPS Requirements

- **OS:** Ubuntu 20.04+ / Debian 11+
- **RAM:** 2GB minimum, 4GB recommended
- **Disk:** 20GB minimum
- **Ports:** 80, 443, 22 (SSH)

### Environment Variables

Created automatically in `.env` on VPS:

```bash
# OpenAI Configuration
OPENAI_API_KEY=sk-your-key-here

# Server Configuration
HOST=0.0.0.0
PORT=8084
ENVIRONMENT=production

# Security
SECRET_KEY=<auto-generated>
ALLOWED_ORIGINS=http://your-domain,https://your-domain

# Database
DATABASE_URL=postgresql://user:pass@postgres:5432/pramiti_ai

# Redis
REDIS_URL=redis://redis:6379/0
```

### Customization

Edit on VPS after deployment:

```bash
ssh user@vps-ip
cd Pramiti_AI
nano .env
docker-compose restart
```

---

## üìä Monitoring

### Quick Health Check

```bash
./check_status.sh
```

### Detailed Monitoring

```bash
# SSH into VPS
ssh user@vps-ip
cd Pramiti_AI

# Live logs
docker-compose logs -f pramiti-ai

# Service status
docker-compose ps

# Resource usage
docker stats
```

### Access Points

- **Dashboard:** `http://your-vps-ip/enhanced-dashboard`
- **API Docs:** `http://your-vps-ip/docs`
- **Health Check:** `http://your-vps-ip/health`

---

## üîí Security Features

### Automatic Security Setup

The deployment script automatically:

1. **Firewall Configuration**
   - Opens only ports 80, 443, 22
   - Blocks all other incoming traffic

2. **Secure Secrets**
   - Auto-generates strong SECRET_KEY
   - Auto-generates database passwords
   - Stores in `.env` (git-ignored)

3. **Container Isolation**
   - Non-root user inside containers
   - Private Docker network
   - Limited resource access

### Optional: SSL Setup

```bash
# On VPS (after DNS is pointed to VPS)
sudo apt-get install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com

# Auto-renewal is configured automatically
```

---

## üóÑÔ∏è Database Management

### Automatic Backups

```bash
# On VPS - create backup script
cat > ~/backup.sh << 'EOF'
#!/bin/bash
cd ~/Pramiti_AI
docker-compose exec postgres pg_dump -U pramiti_user pramiti_ai > backup_$(date +%Y%m%d).sql
# Keep last 7 days
find . -name "backup_*.sql" -mtime +7 -delete
EOF

chmod +x ~/backup.sh

# Add to crontab (daily at 2 AM)
crontab -e
# Add: 0 2 * * * /root/backup.sh
```

### Manual Backup

```bash
ssh user@vps-ip 'cd Pramiti_AI && docker-compose exec postgres pg_dump -U pramiti_user pramiti_ai' > backup.sql
```

### Restore

```bash
cat backup.sql | ssh user@vps-ip 'cd Pramiti_AI && docker-compose exec -T postgres psql -U pramiti_user pramiti_ai'
```

---

## üö® Troubleshooting

### Deployment Failed

```bash
# Check logs
./check_status.sh

# Or SSH and check manually
ssh user@vps-ip
cd Pramiti_AI
docker-compose logs pramiti-ai
```

### Can't Access Dashboard

1. **Check firewall:**
   ```bash
   ssh user@vps-ip 'sudo ufw status'
   ```

2. **Check services:**
   ```bash
   ssh user@vps-ip 'cd Pramiti_AI && docker-compose ps'
   ```

3. **Restart services:**
   ```bash
   ssh user@vps-ip 'cd Pramiti_AI && docker-compose restart'
   ```

### Update Failed

```bash
# SSH into VPS
ssh user@vps-ip
cd Pramiti_AI

# Check what's wrong
docker-compose logs --tail=50 pramiti-ai

# Force rebuild
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

### Out of Disk Space

```bash
# Clean Docker
ssh user@vps-ip 'docker system prune -a --volumes'

# Check disk usage
ssh user@vps-ip 'df -h'
```

---

## üí° Pro Tips

### 1. Test Before Deploying

```bash
# Always test locally first
python3 api_server.py
# Visit http://localhost:8084
# Verify changes work

# Then deploy
./update_deployment.sh
```

### 2. Use Feature Branches

```bash
git checkout -b feature/my-enhancement
# Make changes...
git commit -m "Add enhancement"

# When ready to deploy:
git checkout main
git merge feature/my-enhancement
./update_deployment.sh
```

### 3. Monitor After Deployment

```bash
# Deploy
./update_deployment.sh

# Watch logs for a few minutes
ssh user@vps-ip 'cd Pramiti_AI && docker-compose logs -f pramiti-ai'
```

### 4. Regular Health Checks

```bash
# Add to your daily routine
./check_status.sh
```

### 5. Keep Local and Remote in Sync

```bash
# Pull latest changes before making new ones
git pull origin main

# Make changes...

# Deploy
./update_deployment.sh
```

---

## üìà Scaling

### Vertical Scaling (More Resources)

Edit `docker-compose.yml` on VPS:

```yaml
services:
  pramiti-ai:
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 4G
        reservations:
          cpus: '1'
          memory: 2G
```

Then: `docker-compose up -d`

### Horizontal Scaling (Multiple Instances)

For high traffic, consider:
1. Load balancer (nginx)
2. Multiple app containers
3. Separate database server
4. Redis for session sharing

---

## üéì Learning Path

### Week 1: Basic Operations
- [x] Deploy application
- [x] Access dashboard
- [x] Create organizations
- [x] Make simple UI changes
- [x] Deploy updates

### Week 2: Monitoring
- [x] Check logs regularly
- [x] Monitor resource usage
- [x] Set up backups
- [x] Test restore process

### Week 3: Advanced
- [x] Set up SSL certificate
- [x] Configure custom domain
- [x] Optimize performance
- [x] Set up monitoring alerts

---

## üìû Need Help?

### Check Documentation
1. **CONTINUOUS_DEPLOYMENT.md** - Complete workflow guide
2. **DEPLOYMENT_GUIDE.md** - Detailed technical docs
3. **QUICK_DEPLOY.md** - Quick reference

### Common Issues Solutions

| Problem | Solution |
|---------|----------|
| SSH connection fails | Check VPS IP, verify SSH key |
| Services won't start | Check logs: `docker-compose logs` |
| Port 8084 in use | `docker-compose down && docker-compose up -d` |
| Out of memory | Upgrade VPS or optimize resources |
| Can't access dashboard | Check firewall, verify services running |

### Debug Commands

```bash
# Full system check
./check_status.sh

# Service status
ssh user@vps-ip 'cd Pramiti_AI && docker-compose ps'

# Live logs
ssh user@vps-ip 'cd Pramiti_AI && docker-compose logs -f'

# Restart everything
ssh user@vps-ip 'cd Pramiti_AI && docker-compose restart'

# Nuclear option (rebuild everything)
ssh user@vps-ip 'cd Pramiti_AI && docker-compose down && docker-compose up -d --build'
```

---

## ‚ú® Summary

**Your complete workflow:**

```bash
# One-time setup
./deploy_interactive.sh

# Regular updates (2-3 minutes each)
./update_deployment.sh

# Health monitoring (anytime)
./check_status.sh
```

**That's it!** You now have:
- ‚úÖ Automated deployment
- ‚úÖ Continuous updates
- ‚úÖ Health monitoring
- ‚úÖ Production-ready setup
- ‚úÖ Complete documentation

**Start deploying now:**
```bash
./deploy_interactive.sh
```

üéâ **Happy deploying!** üöÄ
